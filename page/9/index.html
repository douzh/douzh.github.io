<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>OneKBase</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta property="og:type" content="website">
<meta property="og:title" content="OneKBase">
<meta property="og:url" content="http://www.onekbase.com/page/9/index.html">
<meta property="og:site_name" content="OneKBase">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="证心">
<meta name="twitter:card" content="summary">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
  
<meta name="generator" content="Hexo 6.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">OneKBase</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">归一</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"><span class="fa fa-bars"></span></a>
        
          <a class="main-nav-link" href="/">首页</a>
        
          <a class="main-nav-link" href="/archives">归档</a>
        
          <a class="main-nav-link" target="_blank" rel="noopener" href="http://site.onekbase.com">ITEEDU</a>
        
          <a class="main-nav-link" href="/about/">关于</a>
        
      </nav>
      <nav id="sub-nav">
        
        
        <a class="nav-icon nav-search-btn" title="搜索"><span class="fa fa-search"></span></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="搜索"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://www.onekbase.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  
    <article id="post-blog/plang/lisp/pcldiary/chapter5" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/blog/plang/lisp/pcldiary/chapter5/" class="article-date">
  <time class="dt-published" datetime="2017-01-07T15:31:57.000Z" itemprop="datePublished">2017-01-07</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/">编程语言</a>►<a class="article-category-link" href="/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Lisp/">Lisp</a>►<a class="article-category-link" href="/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Lisp/Common-Lisp/">Common Lisp</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/blog/plang/lisp/pcldiary/chapter5/">第5章函数-实用Common Lisp编程笔记</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="可选形参-amp-optional"><a href="#可选形参-amp-optional" class="headerlink" title="可选形参 &amp;optional"></a>可选形参 &amp;optional</h2><pre><code>CL-USER&gt; (defun foo (a b &amp;optional c d) (list a b c d))
FOO
CL-USER&gt; (foo 1 2)
(1 2 NIL NIL)
CL-USER&gt; (foo 1 2 3)
(1 2 3 NIL)
CL-USER&gt; (foo 1 2 3 4)
(1 2 3 4)
CL-USER&gt; 
</code></pre>
<p>带参数的可选形参</p>
<pre><code>CL-USER&gt; (foo 1 2)
(1 2)
CL-USER&gt; (foo 1)
(1 10)
</code></pre>
<p>带调用标识的可选形参</p>
<pre><code>CL-USER&gt; (defun foo (a b &amp;optional (c 3 c_supplied-p)) (list a b c c_supplied-p))
FOO
CL-USER&gt; (foo 1 2)
(1 2 3 NIL)
CL-USER&gt; (foo 1 2 3)
(1 2 3 T)
CL-USER&gt; (foo 1 2 4)
(1 2 4 T)
CL-USER&gt; 
</code></pre>
<h2 id="剩余形参-amp-rest"><a href="#剩余形参-amp-rest" class="headerlink" title="剩余形参 &amp;rest"></a>剩余形参 &amp;rest</h2><pre><code>CL-USER&gt; (defun add (&amp;rest numbers) (format t &quot;~a&quot; numbers))
ADD
CL-USER&gt; (add 1 2 3)
(1 2 3)
NIL
</code></pre>
<h2 id="关键字形参-amp-key"><a href="#关键字形参-amp-key" class="headerlink" title="关键字形参 &amp;key"></a>关键字形参 &amp;key</h2><pre><code>CL-USER&gt; (defun foo (&amp;key a b c)(list a b c))
FOO
CL-USER&gt; (foo)
(NIL NIL NIL)
CL-USER&gt; (foo :a 1)
(1 NIL NIL)
CL-USER&gt; (foo :b 1)
(NIL 1 NIL)
CL-USER&gt; (foo :c 1)
(NIL NIL 1)
CL-USER&gt; (foo :a 1 :c 3)
(1 NIL 3)
CL-USER&gt; (foo :c 3 :b 2 :a 1)
(1 2 3)
CL-USER&gt; 
</code></pre>
<p>带标识的关键字参数</p>
<pre><code>CL-USER&gt; (defun foo (&amp;key (a 0) (b 0 b-supplied-p)(c (+ a b)))
       (list a b c b-supplied-p))
FOO
CL-USER&gt; (foo )
(0 0 0 NIL)
CL-USER&gt; (foo :a 1 :b 2)
(1 2 3 T)
</code></pre>
<p>改变关键字</p>
<pre><code>CL-USER&gt; (defun foo (&amp;key ((:apple a)) ((:box b) 0) ((:charlie c) 0 c-supplied-p))
       (list a b c c-supplied-p))
FOO
CL-USER&gt; (foo :apple 10 :box 20 :charlie 30)
(10 20 30 T)
</code></pre>
<h2 id="组合"><a href="#组合" class="headerlink" title="组合"></a>组合</h2><p>&amp;optional &amp;key</p>
<p>&amp;rest &amp;key</p>
<p>这两种组合会产生奇怪行为。</p>
<p>当&amp;optiona不足时会吞掉&amp;key的key和value。</p>
<p>&amp;rest会收集&amp;key的key和value。</p>
<pre><code>CL-USER&gt; (defun foo (&amp;rest rest &amp;key a b c)(list rest a b c))
FOO
CL-USER&gt; (foo :a 1 :b 2 :c 3)
((:A 1 :B 2 :C 3) 1 2 3)
CL-USER&gt; #&#39;foo
#&lt;Compiled-function FOO #x2100910C5F&gt;
CL-USER&gt; 
</code></pre>
<h2 id="return-from"><a href="#return-from" class="headerlink" title="return-from"></a>return-from</h2><h2 id="高阶函数"><a href="#高阶函数" class="headerlink" title="高阶函数"></a>高阶函数</h2><h3 id="操作符FUNCTION"><a href="#操作符FUNCTION" class="headerlink" title="操作符FUNCTION"></a>操作符FUNCTION</h3><p>用来获取函数对象，语法糖为#‘</p>
<pre><code>CL-USER&gt; (defun foo () ())
FOO
CL-USER&gt; (function foo)
#&lt;Compiled-function FOO #x2100910C5F&gt;
CL-USER&gt; 
</code></pre>
<h3 id="调用函数对象"><a href="#调用函数对象" class="headerlink" title="调用函数对象"></a>调用函数对象</h3><p>funcall</p>
<pre><code>(foo 1 2 3)
(funcall #&#39;foo 1 2 3)
</code></pre>
<p>一个例子</p>
<pre><code>CL-USER&gt; (defun plot (fn min max step)
       (loop for i from min to max by step do
        (loop repeat (funcall fn i) do (format t &quot;*&quot;))
        (format t &quot;~%&quot;)))
PLOT
CL-USER&gt; (plot #&#39;exp 0 4 1/2)
*
*
**
****
*******
************
********************
*********************************
******************************************************
NIL
CL-USER&gt; 
</code></pre>
<p>apply</p>
<p>接收一个列表为函数参数</p>
<pre><code>CL-USER&gt; (defun foo (a b c) (list a b c))
FOO
CL-USER&gt; (apply #&#39;foo &#39;(1 2 3))
(1 2 3)
CL-USER&gt; (apply #&#39;foo 1 2 3 ())
(1 2 3)
CL-USER&gt; (apply #&#39;foo 1 2 &#39;(3))
(1 2 3)
</code></pre>
<h2 id="匿名函数"><a href="#匿名函数" class="headerlink" title="匿名函数"></a>匿名函数</h2><p>CL-USER&gt; (plot #’(lambda (x) (* 2 x)) 0 10 1)</p>
<pre><code>**
****
******
********
**********
************
**************
****************
******************
********************
NIL
CL-USER&gt; 
</code></pre>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.onekbase.com/blog/plang/lisp/pcldiary/chapter5/" data-id="clhlnylj400xzojupel9oh9zt" data-title="第5章函数-实用Common Lisp编程笔记" class="article-share-link"><span class="fa fa-share">分享</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Common-Lisp/" rel="tag">Common Lisp</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-blog/plang/lisp/pcldiary/chapter3" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/blog/plang/lisp/pcldiary/chapter3/" class="article-date">
  <time class="dt-published" datetime="2017-01-07T14:54:13.000Z" itemprop="datePublished">2017-01-07</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/">编程语言</a>►<a class="article-category-link" href="/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Lisp/">Lisp</a>►<a class="article-category-link" href="/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Lisp/Common-Lisp/">Common Lisp</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/blog/plang/lisp/pcldiary/chapter3/">第3章简单的数据库-实用Common Lisp编程笔记</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h3 id="属性表"><a href="#属性表" class="headerlink" title="属性表"></a>属性表</h3><pre><code>CL-USER&gt; (getf (list :a 1 :b 2 :c 3) :a)
1
</code></pre>
<h3 id="make-cd"><a href="#make-cd" class="headerlink" title="make-cd"></a>make-cd</h3><pre><code> (defun make-cd (title artist rating ripped)
    (list :tilte title :artist artist :rating rating :ripped ripped))
</code></pre>
<h3 id="DEFVAR"><a href="#DEFVAR" class="headerlink" title="DEFVAR"></a>DEFVAR</h3><p>定义全局变量</p>
<pre><code>(defvar *db* nil)
</code></pre>
<h3 id="add-record"><a href="#add-record" class="headerlink" title="add-record"></a>add-record</h3><pre><code>(defun add-record (cd) (push cd *db*))
</code></pre>
<h3 id="录入"><a href="#录入" class="headerlink" title="录入"></a>录入</h3><pre><code>CL-USER&gt; (add-record (make-cd &quot;roses&quot; &quot;kathy&quot; 7 t))
((:TILTE &quot;roses&quot; :ARTIST &quot;kathy&quot; :RATING 7 :RIPPED T))
CL-USER&gt; (add-record (make-cd &quot;roses2&quot; &quot;kathy2&quot; 8 t))
((:TILTE &quot;roses2&quot; :ARTIST &quot;kathy2&quot; :RATING 8 :RIPPED T)
(:TILTE &quot;roses&quot; :ARTIST &quot;kathy&quot; :RATING 7 :RIPPED T))
CL-USER&gt; (add-record (make-cd &quot;roses3&quot; &quot;kathy3&quot; 9 t))
((:TILTE &quot;roses3&quot; :ARTIST &quot;kathy3&quot; :RATING 9 :RIPPED T)
(:TILTE &quot;roses2&quot; :ARTIST &quot;kathy2&quot; :RATING 8 :RIPPED T)
(:TILTE &quot;roses&quot; :ARTIST &quot;kathy&quot; :RATING 7 :RIPPED T))
CL-USER&gt; 
</code></pre>
<h3 id="查看"><a href="#查看" class="headerlink" title="查看"></a>查看</h3><pre><code>CL-USER&gt; *db*
((:TILTE &quot;roses3&quot; :ARTIST &quot;kathy3&quot; :RATING 9 :RIPPED T)
(:TILTE &quot;roses2&quot; :ARTIST &quot;kathy2&quot; :RATING 8 :RIPPED T)
(:TILTE &quot;roses&quot; :ARTIST &quot;kathy&quot; :RATING 7 :RIPPED T))
CL-USER&gt; 
</code></pre>
<h3 id="dump-db"><a href="#dump-db" class="headerlink" title="dump-db"></a>dump-db</h3><pre><code>(defun dump-db()
    (dolist (cd *db*)
        (format t &quot;~&#123;~a: ~10t~a~%~&#125;~%&quot; cd)))
</code></pre>
<p>format</p>
<pre><code>~a: ~10t~a~%~
</code></pre>
<p>处理一个键值对。</p>
<pre><code>~&#123;~a: ~10t~a~%~&#125;
</code></pre>
<p>循环处理列表所有键值对。</p>
<pre><code>(defun dump-db ()
    (format t &quot;~&#123;~&#123;~a: ~10t~a~%~&#125;~%~&#125;&quot; *db*))
</code></pre>
<h3 id="format"><a href="#format" class="headerlink" title="format"></a>format</h3><pre><code>~a
</code></pre>
<p>美化，关键字没有前导冒号，字段串没有双引号。</p>
<pre><code>~10t
</code></pre>
<p>输出制表符。</p>
<pre><code>~&#123;~&#125;
</code></pre>
<p>列表处理部分。</p>
<pre><code>~%
</code></pre>
<p>换行。</p>
<h3 id="交互读取"><a href="#交互读取" class="headerlink" title="交互读取"></a>交互读取</h3><pre><code>(defun prompt-read (prompt)
    (format *query-io* &quot;~a: &quot; prompt)
    (force-output *query-io*)
    (read-line *query-io*))
</code></pre>
<p><em>query-io</em></p>
<p>当前终端输入流的全局变量。</p>
<pre><code>(defun prompt-for-cd () 
    (make-cd 
        (prompt-read &quot;title&quot;)
        (prompt-read &quot;artist&quot;)
        (prompt-read &quot;rating&quot;)
        (prompt-read &quot;ripped [y/n]&quot;)))
         
(defun prompt-for-cd () 
    (make-cd 
        (prompt-read &quot;title&quot;)
        (prompt-read &quot;artist&quot;)
        (or (parse-integer (prompt-read &quot;rating&quot;) :junk-allowed t) 0)
        (y-or-n-p &quot;ripped [y/n]&quot;)))

(defun add-cds ()
   (loop (add-record (prompt-for-cd))
      (if (not (y-or-n-p &quot;another? [y/n]: &quot;)) (return))))     
</code></pre>
<h3 id="保存和加载数据库"><a href="#保存和加载数据库" class="headerlink" title="保存和加载数据库"></a>保存和加载数据库</h3><pre><code>(defun save-db (filename)
  (with-open-file (out filename
               :direction :output
               :if-exists :supersede)
    (with-standard-io-syntax
      (print *db* out))))
</code></pre>
<p>:direction :output</p>
<p>用于写入的文件。</p>
<p>:if-exists :supersede</p>
<p>覆盖已经存在的文件。</p>
<pre><code>(defun load-db (filename)
  (with-open-file (in filename)
    (with-standard-io-syntax
      (setf *db* (read in)))))
</code></pre>
<h3 id="remove-if-not"><a href="#remove-if-not" class="headerlink" title="remove-if-not"></a>remove-if-not</h3><pre><code>CL-USER&gt; (remove-if-not #&#39;evenp &#39;(1 2 3 4 5 6 7 8 9 10))
(2 4 6 8 10)
</code></pre>
<p>​<br>​    CL-USER&gt; (remove-if-not #’(lambda (x) (&#x3D; 0 (mod x 2)))<br>​    		‘(1 2 3 4 5 6 7 8 9 10))<br>​    (2 4 6 8 10)</p>
<h3 id="查询数据库"><a href="#查询数据库" class="headerlink" title="查询数据库"></a>查询数据库</h3><pre><code>(defun select (select-fn)
    (remove-if-not select-fn *db*))
  
(defun select-by-artist (artist)
  (remove-if-not
   #&#39;(lambda (cd) (equal (getf cd :artist) artist))
   *db*))
   
(defun artist-selector (artist)
    #&#39;(lambda (cd) (equal (getf cd :artist) artist)))
</code></pre>
<h3 id="where"><a href="#where" class="headerlink" title="where"></a>where</h3><pre><code>(defun where (&amp;key title artist rating (ripped nil ripped-p))
  #&#39;(lambda (cd)
      (and
       (if title (equal (getf cd :title) title) t)
       (if artist (equal (getf cd :artist) artist) t)
       (if rating (equal (getf cd :rating) rating) t)
       (if ripped-p (equal (getf cd :ripped) ripped) t))))
</code></pre>
<h3 id="update"><a href="#update" class="headerlink" title="update"></a>update</h3><pre><code>(defun update (selector-fn &amp;key title artist rating (ripped nil ripped-p))
  (setf *db*
    (mapcar
     #&#39;(lambda (row)
         (when (funcall selector-fn row)
           (if title (setf (getf row :title) title))
           (if artist (setf (getf row :artist) artist))
           (if rating (setf (getf row :rating) rating))
           (if ripped-p (setf (getf row :ripped) ripped)))
         row) *db*)))
</code></pre>
<h3 id="macro"><a href="#macro" class="headerlink" title="macro"></a>macro</h3><pre><code>CL-USER&gt; (defun make-comparison-expr (field value)
       (list &#39;equal (list &#39;getf &#39;cd field) value))
MAKE-COMPARISON-EXPR
CL-USER&gt; (make-comparison-expr :rating 10)
(EQUAL (GETF CD :RATING) 10)
</code></pre>
<p>反引号</p>
<p>任何以逗号开始的子句会被求值</p>
<pre><code>CL-USER&gt; `(1 2 (+ 1 2))
(1 2 (+ 1 2))
CL-USER&gt; `(1 2 ,(+ 1 2))
(1 2 3)
CL-USER&gt; 
</code></pre>
<p>where宏</p>
<pre><code>(defun make-comparison-expr (field value)
    `(equal (getf cd ,field) ,value))

(defun make-comparisons-list (fields)
    (loop while fields
        collecting (make-comparison-expr (pop fields) (pop fields))))
          
(defmacro where (&amp;rest clauses)
    `#&#39;(lambda (cd) (and ,@(make-comparisons-list clauses))))
</code></pre>
<h3 id=""><a href="#" class="headerlink" title=",@"></a>,@</h3><pre><code>CL-USER&gt; `(and ,(list 1 2 3))
(AND (1 2 3))
CL-USER&gt; `(and ,@(list 1 2 3))
(AND 1 2 3)
</code></pre>
<h3 id="macroexpand-1"><a href="#macroexpand-1" class="headerlink" title="macroexpand-1"></a>macroexpand-1</h3><pre><code>CL-USER&gt; (macroexpand-1 &#39;(where :title &quot;adafdsf&quot; :ripped t))
#&#39;(LAMBDA (CD) (AND (EQUAL (GETF CD :TITLE) &quot;adafdsf&quot;) (EQUAL (GETF CD :RIPPED) T)))
T
</code></pre>
<p>​           </p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.onekbase.com/blog/plang/lisp/pcldiary/chapter3/" data-id="clhlnylj300xwojup4fhtfbag" data-title="第3章简单的数据库-实用Common Lisp编程笔记" class="article-share-link"><span class="fa fa-share">分享</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Common-Lisp/" rel="tag">Common Lisp</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-blog/tools/markdown/editormd" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/blog/tools/markdown/editormd/" class="article-date">
  <time class="dt-published" datetime="2017-01-05T14:10:16.000Z" itemprop="datePublished">2017-01-05</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E5%B7%A5%E5%85%B7/">工具</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/blog/tools/markdown/editormd/">Markdown 在线编辑器editormd使用笔记</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="集成editormd编辑器"><a href="#集成editormd编辑器" class="headerlink" title="集成editormd编辑器"></a>集成editormd编辑器</h2><p>下载editormd开源包里面的样例文件：</p>
<p><a target="_blank" rel="noopener" href="http://iteedu.com/editormd/examples/index.html">http://iteedu.com/editormd/examples/index.html</a></p>
<p>在网页中添加如下代码。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;editormd&quot;</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">textarea</span> <span class="attr">style</span>=<span class="string">&quot;display: none;&quot;</span> <span class="attr">name</span>=<span class="string">&quot;content&quot;</span> <span class="attr">id</span>=<span class="string">&quot;content&quot;</span>&gt;</span><span class="meta">&lt;?php ;echo $o[&#x27;content&#x27;]; ?&gt;</span>&amp;lt/textarea&gt;</span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;/include/js/jquery.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;/editormd/editormd.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">	$(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">		<span class="keyword">var</span> editor = <span class="title function_">editormd</span>(<span class="string">&quot;editormd&quot;</span>, &#123;</span></span><br><span class="line"><span class="language-javascript">			path : <span class="string">&quot;../editormd/lib/&quot;</span> <span class="comment">// Autoload modules mode, codemirror, marked... dependents libs path</span></span></span><br><span class="line"><span class="language-javascript">		&#125;);</span></span><br><span class="line"><span class="language-javascript">	&#125;);</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>如果还想用编辑器样式，还要引入样式文件：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;/editormd/examples/css/style.css&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;/editormd/css/editormd.css&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="用editormd显示markdown文件"><a href="#用editormd显示markdown文件" class="headerlink" title="用editormd显示markdown文件"></a>用editormd显示markdown文件</h2><p>这是我在php中输出的集成代码，$fcontent是从数据加载的markdown文本。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;&lt;div id=&quot;editormd-view&quot;&gt;</span></span><br><span class="line"><span class="string">		&lt;textarea style=&quot;display:none;&quot;&gt;&#x27;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$fcontent</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;&amp;lt/textarea&gt;&lt;/div&gt;&#x27;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;</span></span><br><span class="line"><span class="string">&lt;script src=&quot;/editormd/lib/marked.min.js&quot;&gt;&lt;/script&gt;</span></span><br><span class="line"><span class="string">&lt;script src=&quot;/editormd/lib/prettify.min.js&quot;&gt;&lt;/script&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&lt;script src=&quot;/editormd/lib/raphael.min.js&quot;&gt;&lt;/script&gt;</span></span><br><span class="line"><span class="string">&lt;script src=&quot;/editormd/lib/underscore.min.js&quot;&gt;&lt;/script&gt;</span></span><br><span class="line"><span class="string">&lt;script src=&quot;/editormd/lib/sequence-diagram.min.js&quot;&gt;&lt;/script&gt;</span></span><br><span class="line"><span class="string">&lt;script src=&quot;/editormd/lib/flowchart.min.js&quot;&gt;&lt;/script&gt;</span></span><br><span class="line"><span class="string">&lt;script src=&quot;/editormd/lib/jquery.flowchart.min.js&quot;&gt;&lt;/script&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&lt;script src=&quot;/editormd/editormd.js&quot;&gt;&lt;/script&gt;</span></span><br><span class="line"><span class="string">&lt;script type=&quot;text/javascript&quot;&gt;</span></span><br><span class="line"><span class="string">	$(function() &#123;</span></span><br><span class="line"><span class="string">		var testEditormdView;</span></span><br><span class="line"><span class="string">		editormdView = editormd.markdownToHTML(&quot;editormd-view&quot;, &#123;</span></span><br><span class="line"><span class="string">			htmlDecode      : &quot;style,script,iframe&quot;,  // you can filter tags decode</span></span><br><span class="line"><span class="string">			emoji           : true,</span></span><br><span class="line"><span class="string">			taskList        : true,</span></span><br><span class="line"><span class="string">			tex             : true,  // 默认不解析</span></span><br><span class="line"><span class="string">			flowChart       : true,  // 默认不解析</span></span><br><span class="line"><span class="string">			sequenceDiagram : true,  // 默认不解析</span></span><br><span class="line"><span class="string">		&#125;);</span></span><br><span class="line"><span class="string">	&#125;);</span></span><br><span class="line"><span class="string">&lt;/script&gt;&#x27;</span>;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.onekbase.com/blog/tools/markdown/editormd/" data-id="clhlnylge00ifojupfhloa9pr" data-title="Markdown 在线编辑器editormd使用笔记" class="article-share-link"><span class="fa fa-share">分享</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Markdown/" rel="tag">Markdown</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%A5%9E%E5%99%A8/" rel="tag">神器</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-blog/plang/lisp/lispdiary/installslime" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/blog/plang/lisp/lispdiary/installslime/" class="article-date">
  <time class="dt-published" datetime="2016-07-26T07:38:29.000Z" itemprop="datePublished">2016-07-26</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/">编程语言</a>►<a class="article-category-link" href="/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Lisp/">Lisp</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/blog/plang/lisp/lispdiary/installslime/">lisp开发环境之安装slime</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>Slime 的意思是“Emacs 下优秀的 Lisp 交互式开发模式”。</p>
<p>通过支持 Common Lisp 的交互式编程，Slime 扩展了 Emacs。所以的特性都基于 slime-mode，一个 Emacs 的 minor-mode，它为标准的 lisp-mode 提供补充。lisp-mode 为编辑 Lisp 源文件提供支持，而 slime-mode 则提供了与一个 Lisp 进程进行交互的功能，包括编译、调试、文档查找等等。</p>
<p>Slime 由两部分组成：用 Emacs Lisp 写的用户界面，和用 Common Lisp 写的服务器端。这两部分通过套接字连接在一起，并且使用一个类似于 RPC 的协议通信。</p>
<p>服务器端的 Lisp 主要是可移植的 Commom Lisp。所需要的跟特定 Lisp 实现相关的特性都由一个接口定义好，然后由不同的 Lisp 实现提供。这使得 Slime 非常容易移植。</p>
<p>有名的LispBox集成开发环境也只是emacs+slime+ccl+quicklisp的集成。</p>
<h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><p>你可以选择使用发行版本的 Slime 或者直接通过 CVS 仓库使用 Slime。你可以从我们的网站下载最新发布版本： <a target="_blank" rel="noopener" href="http://www.common-lisp.net/project/slime/">http://www.common-lisp.net/project/slime/</a> 。</p>
<p>如果你已经有了一个可以从命令行启动的 Lisp 实现，那么仅需在 .emacs 文件中添加几行即可安装成功：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">(setq inferior-lisp-program &quot;/opt/sbcl/bin/sbcl&quot;) ; your Lisp system</span><br><span class="line">(add-to-list &#x27;load-path &quot;~/hacking/lisp/slime/&quot;)  ; your SLIME directory</span><br><span class="line">(require &#x27;slime)</span><br><span class="line">(slime-setup)</span><br></pre></td></tr></table></figure>

<p>这是没有其它杂项的最小化配置。</p>
<p>在windows环境中inferior-lisp-program要指定到sbcl.exe的全路径</p>
<p>注：sbcl在window环境安装后要重新启动电脑，否则会报找不到sbcl.core的错误。</p>
<h2 id="启动-Slime"><a href="#启动-Slime" class="headerlink" title="启动 Slime"></a>启动 Slime</h2><p>Emacs 命令 M-x slime 可以启动 Slime。它使用 inferior-lisp 包来启动一个 Lisp 进程，加载并启动 Lisp 端服务器（叫做“Swank”），然后在 Emacs 和 Lisp 之间建立一个 socket 连接。最后会生成一个 REPL 缓冲区，你可以在这里输入 Lisp 表达式并求值。</p>
<h2 id="自动加载"><a href="#自动加载" class="headerlink" title="自动加载"></a>自动加载</h2><p>基本设置始终会加载 Slime，即使你不使用它。如果你只在需要的时候才加载 Slime，那么 Emacs 会启动的快一点。要这样，你需要稍微更改你的 .emacs 文件：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">(setq inferior-lisp-program &quot;the path to your Lisp system&quot;)</span><br><span class="line">(add-to-list &#x27;load-path &quot;the path of your slime directory&quot;)</span><br><span class="line">(require &#x27;slime-autoloads)</span><br><span class="line">(slime-setup)</span><br><span class="line">;让slime变得更好看，比如把sbcl的*变成CL-USER&gt;</span><br><span class="line">(slime-setup &#x27;(slime-fancy))</span><br></pre></td></tr></table></figure>

<p>跟基本配置相比，差别只在这一行 (require ‘slime-autoloads)。它告诉 Emacs 当 M-x slime 或者 M-x slime-connect 命令第一次执行之后 Slime 的其它部分会被自动加载。</p>
<p>摘选自:<a target="_blank" rel="noopener" href="http://www.open-open.com/lib/view/open1400054028504.html">http://www.open-open.com/lib/view/open1400054028504.html</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.onekbase.com/blog/plang/lisp/lispdiary/installslime/" data-id="clhlnyli000rqojupcukwd972" data-title="lisp开发环境之安装slime" class="article-share-link"><span class="fa fa-share">分享</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Lisp/" rel="tag">Lisp</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-blog/nosql/mongodb/mapreduce" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/blog/nosql/mongodb/mapreduce/" class="article-date">
  <time class="dt-published" datetime="2016-05-31T09:43:57.000Z" itemprop="datePublished">2016-05-31</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/nosql/">nosql</a>►<a class="article-category-link" href="/categories/nosql/MongoDB/">MongoDB</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/blog/nosql/mongodb/mapreduce/">MongoDB Map Reduce</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>Map-Reduce是一种计算模型，简单的说就是将大批量的工作（数据）分解（MAP）执行，然后再将结果合并成最终结果（REDUCE）。</p>
<p>MongoDB提供的Map-Reduce非常灵活，对于大规模数据分析也相当实用。</p>
<h2 id="MapReduce-命令"><a href="#MapReduce-命令" class="headerlink" title="MapReduce 命令"></a>MapReduce 命令</h2><p>以下是MapReduce的基本语法：</p>
<pre><code>&gt;db.collection.mapReduce(
   function() &#123;emit(key,value);&#125;,  //map 函数
   function(key,values) &#123;return reduceFunction&#125;,   //reduce 函数
   &#123;
      out: collection,
      query: document,
      sort: document,
      limit: number
   &#125;
)
</code></pre>
<p>使用 MapReduce 要实现两个函数 Map 函数和 Reduce 函数,Map 函数调用<br>emit(key, value),遍历 collection 中所有的记录, 将key 与 value 传递给<br>Reduce 函数进行处理。</p>
<p>Map 函数必须调用 emit(key, value) 返回键值对。</p>
<p>参数说明:</p>
<ul>
<li><strong>map</strong> ：映射函数 (生成键值对序列,作为 reduce 函数参数)。</li>
<li><strong>reduce</strong><br>统计函数，reduce函数的任务就是将key-values变成key-value，也就是把values数组变成一个单一的值value。。</li>
<li><strong>out</strong> 统计结果存放集合<br>(不指定则使用临时集合,在客户端断开后自动删除)。</li>
<li><strong>query</strong><br>一个筛选条件，只有满足条件的文档才会调用map函数。（query。limit，sort可以随意组合）</li>
<li><strong>sort</strong><br>和limit结合的sort排序参数（也是在发往map函数前给文档排序），可以优化分组机制</li>
<li><strong>limit</strong><br>发往map函数的文档数量的上限（要是没有limit，单独使用sort的用处不大）</li>
</ul>
<h2 id="使用-MapReduce"><a href="#使用-MapReduce" class="headerlink" title="使用 MapReduce"></a>使用 MapReduce</h2><p>考虑以下文档结构存储用户的文章，文档存储了用户的 user_name 和文章的<br>status 字段：</p>
<pre><code>&gt;db.posts.insert(&#123;
   &quot;post_text&quot;: &quot;菜鸟教程，最全的技术文档。&quot;,
   &quot;user_name&quot;: &quot;mark&quot;,
   &quot;status&quot;:&quot;active&quot;
&#125;)
WriteResult(&#123; &quot;nInserted&quot; : 1 &#125;)
&gt;db.posts.insert(&#123;
   &quot;post_text&quot;: &quot;菜鸟教程，最全的技术文档。&quot;,
   &quot;user_name&quot;: &quot;mark&quot;,
   &quot;status&quot;:&quot;active&quot;
&#125;)
WriteResult(&#123; &quot;nInserted&quot; : 1 &#125;)
&gt;db.posts.insert(&#123;
   &quot;post_text&quot;: &quot;菜鸟教程，最全的技术文档。&quot;,
   &quot;user_name&quot;: &quot;mark&quot;,
   &quot;status&quot;:&quot;active&quot;
&#125;)
WriteResult(&#123; &quot;nInserted&quot; : 1 &#125;)
&gt;db.posts.insert(&#123;
   &quot;post_text&quot;: &quot;菜鸟教程，最全的技术文档。&quot;,
   &quot;user_name&quot;: &quot;mark&quot;,
   &quot;status&quot;:&quot;active&quot;
&#125;)
WriteResult(&#123; &quot;nInserted&quot; : 1 &#125;)
&gt;db.posts.insert(&#123;
   &quot;post_text&quot;: &quot;菜鸟教程，最全的技术文档。&quot;,
   &quot;user_name&quot;: &quot;mark&quot;,
   &quot;status&quot;:&quot;disabled&quot;
&#125;)
WriteResult(&#123; &quot;nInserted&quot; : 1 &#125;)
&gt;db.posts.insert(&#123;
   &quot;post_text&quot;: &quot;菜鸟教程，最全的技术文档。&quot;,
   &quot;user_name&quot;: &quot;runoob&quot;,
   &quot;status&quot;:&quot;disabled&quot;
&#125;)
WriteResult(&#123; &quot;nInserted&quot; : 1 &#125;)
&gt;db.posts.insert(&#123;
   &quot;post_text&quot;: &quot;菜鸟教程，最全的技术文档。&quot;,
   &quot;user_name&quot;: &quot;runoob&quot;,
   &quot;status&quot;:&quot;disabled&quot;
&#125;)
WriteResult(&#123; &quot;nInserted&quot; : 1 &#125;)
&gt;db.posts.insert(&#123;
   &quot;post_text&quot;: &quot;菜鸟教程，最全的技术文档。&quot;,
   &quot;user_name&quot;: &quot;runoob&quot;,
   &quot;status&quot;:&quot;active&quot;
&#125;)
WriteResult(&#123; &quot;nInserted&quot; : 1 &#125;)
</code></pre>
<p>现在，我们将在 posts 集合中使用 mapReduce<br>函数来选取已发布的文章(status:”active”)，并通过user_name分组，计算每个用户的文章数：</p>
<pre><code>&gt;db.posts.mapReduce( 
   function() &#123; emit(this.user_name,1); &#125;, 
   function(key, values) &#123;return Array.sum(values)&#125;, 
      &#123;  
         query:&#123;status:&quot;active&quot;&#125;,  
         out:&quot;post_total&quot; 
      &#125;
)
</code></pre>
<p>以上 mapReduce 输出结果为：</p>
<pre><code>&#123;
        &quot;result&quot; : &quot;post_total&quot;,
        &quot;timeMillis&quot; : 23,
        &quot;counts&quot; : &#123;
                &quot;input&quot; : 5,
                &quot;emit&quot; : 5,
                &quot;reduce&quot; : 1,
                &quot;output&quot; : 2
        &#125;,
        &quot;ok&quot; : 1
&#125;
</code></pre>
<p>结果表明，共有4个符合查询条件（status:”active”）的文档，在map函数中生成了4个键值对文档，最后使用reduce函数将相同的键值分为两组。</p>
<p>具体参数说明：</p>
<ul>
<li>result：储存结果的collection的名字,这是个临时集合，MapReduce的连接关闭后自动就被删除了。</li>
<li>timeMillis：执行花费的时间，毫秒为单位</li>
<li>input：满足条件被发送到map函数的文档个数</li>
<li>emit：在map函数中emit被调用的次数，也就是所有集合中的数据总量</li>
<li>ouput：结果集合中的文档个数**<span
style="color:#ff0000">（count对调试非常有帮助）</span>**</li>
<li>ok：是否成功，成功为1</li>
<li>err：如果失败，这里可以有失败原因，不过从经验上来看，原因比较模糊，作用不大</li>
</ul>
<p>使用 find 操作符来查看 mapReduce 的查询结果：</p>
<pre><code>&gt;db.posts.mapReduce( 
   function() &#123; emit(this.user_name,1); &#125;, 
   function(key, values) &#123;return Array.sum(values)&#125;, 
      &#123;  
         query:&#123;status:&quot;active&quot;&#125;,  
         out:&quot;post_total&quot; 
      &#125;
).find()
</code></pre>
<p>以上查询显示如下结果，两个用户 tom 和 mark 有两个发布的文章:</p>
<pre><code>&#123; &quot;_id&quot; : &quot;mark&quot;, &quot;value&quot; : 4 &#125;
&#123; &quot;_id&quot; : &quot;runoob&quot;, &quot;value&quot; : 1 &#125;
</code></pre>
<p>用类似的方式，MapReduce可以被用来构建大型复杂的聚合查询。</p>
<p>Map函数和Reduce函数可以使用 JavaScript<br>来实现，是的MapReduce的使用非常灵活和强大。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.onekbase.com/blog/nosql/mongodb/mapreduce/" data-id="clhlnylfn00djojupbhzi7szf" data-title="MongoDB Map Reduce" class="article-share-link"><span class="fa fa-share">分享</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/MongoDB/" rel="tag">MongoDB</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/nosql/" rel="tag">nosql</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-blog/nosql/mongodb/gridfs" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/blog/nosql/mongodb/gridfs/" class="article-date">
  <time class="dt-published" datetime="2016-05-31T09:36:58.000Z" itemprop="datePublished">2016-05-31</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/nosql/">nosql</a>►<a class="article-category-link" href="/categories/nosql/MongoDB/">MongoDB</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/blog/nosql/mongodb/gridfs/">MongoDB GridFS</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="GridFS"><a href="#GridFS" class="headerlink" title="GridFS"></a>GridFS</h2><p>用于存储和恢复那些超过16M（BSON文件限制）的文件(如：图片、音频、视频等)。</p>
<p>GridFS 也是文件存储的一种方式，但是它是存储在MonoDB的集合中。</p>
<p>GridFS 可以更好的存储大于16M的文件。</p>
<p>GridFS<br>会将大文件对象分割成多个小的chunk(文件片段),一般为256k&#x2F;个,每个chunk将作为MongoDB的一个文档(document)被存储在chunks集合中。</p>
<p>GridFS 用两个集合来存储一个文件：fs.files与fs.chunks。</p>
<p>每个文件的实际内容被存在chunks(二进制数据)中,和文件有关的meta数据(filename,content_type,还有用户自定义的属性)将会被存在files集合中。</p>
<p>以下是简单的 fs.files 集合文档：</p>
<pre><code>&#123;
   &quot;filename&quot;: &quot;test.txt&quot;,
   &quot;chunkSize&quot;: NumberInt(261120),
   &quot;uploadDate&quot;: ISODate(&quot;2014-04-13T11:32:33.557Z&quot;),
   &quot;md5&quot;: &quot;7b762939321e146569b07f72c62cca4f&quot;,
   &quot;length&quot;: NumberInt(646)
&#125;
</code></pre>
<p>以下是简单的 fs.chunks 集合文档：</p>
<pre><code>&#123;
   &quot;files_id&quot;: ObjectId(&quot;534a75d19f54bfec8a2fe44b&quot;),
   &quot;n&quot;: NumberInt(0),
   &quot;data&quot;: &quot;Mongo Binary Data&quot;
&#125;
</code></pre>
<h2 id="GridFS-添加文件"><a href="#GridFS-添加文件" class="headerlink" title="GridFS 添加文件"></a>GridFS 添加文件</h2><p>现在我们使用 GridFS 的 put 命令来存储 mp3 文件。调用 MongoDB<br>安装目录下bin的 mongofiles.exe工具。</p>
<p>打开命令提示符，进入到MongoDB的安装目录的bin目录中，找到mongofiles.exe，并输入下面的代码：</p>
<pre><code>&gt;mongofiles.exe -d gridfs put song.mp3
</code></pre>
<p>GridFS<br>是存储文件的数据名称。如果不存在该数据库，MongoDB会自动创建。Song.mp3<br>是音频文件名。</p>
<p>使用以下命令来查看数据库中文件的文档：</p>
<pre><code>&gt;db.fs.files.find()
</code></pre>
<p>以上命令执行后返回以下文档数据：</p>
<pre><code>&#123;
   _id: ObjectId(&#39;534a811bf8b4aa4d33fdf94d&#39;), 
   filename: &quot;song.mp3&quot;, 
   chunkSize: 261120, 
   uploadDate: new Date(1397391643474), md5: &quot;e4f53379c909f7bed2e9d631e15c1c41&quot;,
   length: 10401959 
&#125;
</code></pre>
<p>我们可以看到 fs.chunks 集合中所有的区块，以下我们得到了文件的 _id<br>值，我们可以根据这个 _id 获取区块(chunk)的数据：</p>
<pre><code>&gt;db.fs.chunks.find(&#123;files_id:ObjectId(&#39;534a811bf8b4aa4d33fdf94d&#39;)&#125;)
</code></pre>
<p>以上实例中，查询返回了 40<br>个文档的数据，意味着mp3文件被存储在40个区块中。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.onekbase.com/blog/nosql/mongodb/gridfs/" data-id="clhlnylfm00ddojup6u2x09jo" data-title="MongoDB GridFS" class="article-share-link"><span class="fa fa-share">分享</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/MongoDB/" rel="tag">MongoDB</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/nosql/" rel="tag">nosql</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-blog/nosql/mongodb/dump" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/blog/nosql/mongodb/dump/" class="article-date">
  <time class="dt-published" datetime="2016-05-31T09:17:54.000Z" itemprop="datePublished">2016-05-31</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/nosql/">nosql</a>►<a class="article-category-link" href="/categories/nosql/MongoDB/">MongoDB</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/blog/nosql/mongodb/dump/">MongoDB 备份与恢复</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>在Mongodb中我们使用mongodump命令来备份MongoDB数据。该命令可以导出所有数据到指定目录中。</p>
<p>mongodump命令可以通过参数指定导出的数据量级转存的服务器。</p>
<p>mongodump命令脚本语法如下：</p>
<pre><code>&gt;mongodump -h dbhost -d dbname -o dbdirectory
</code></pre>
<ul>
<li><p><strong>-h：</strong></p>
<p>MongDB所在服务器地址，例如：127.0.0.1，当然也可以指定端口号：127.0.0.1:27017</p>
</li>
<li><p><strong>-d：</strong></p>
<p>需要备份的数据库实例，例如：test</p>
</li>
<li><p><strong>-o：</strong></p>
<p>备份的数据存放位置，例如：c:\data\dump，当然该目录需要提前建立，在备份完成后，系统自动在dump目录下建立一个test目录，这个目录里面存放该数据库实例的备份数据。</p>
</li>
</ul>
<p>在本地使用 27017<br>启动你的mongod服务。打开命令提示符窗口，进入MongoDB安装目录的bin目录输入命令mongodump:</p>
<pre><code>&gt;mongodump
</code></pre>
<p>执行以上命令后，客户端会连接到ip为 127.0.0.1 端口号为 27017<br>的MongoDB服务上，并备份所有数据到 bin&#x2F;dump&#x2F; 目录中。</p>
<p>mongodb使用 mongorerstore 命令来恢复备份的数据。</p>
<p>mongorestore命令脚本语法如下：</p>
<pre><code>&gt;mongorestore -h dbhost -d dbname --directoryperdb dbdirectory
</code></pre>
<ul>
<li><p><strong>-h：</strong></p>
<p>MongoDB所在服务器地址</p>
</li>
<li><p><strong>-d：</strong></p>
<p>需要恢复的数据库实例，例如：test，当然这个名称也可以和备份时候的不一样，比如test2</p>
</li>
<li><p><strong>–directoryperdb：</strong></p>
<p>备份数据所在位置，例如：c:\data\dump\test，这里为什么要多加一个test，而不是备份时候的dump，读者自己查看提示吧！</p>
</li>
<li><p><strong>–drop：</strong></p>
<p>恢复的时候，先删除当前数据，然后恢复备份的数据。就是说，恢复后，备份后添加修改的数据都会被删除，慎用哦！</p>
</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.onekbase.com/blog/nosql/mongodb/dump/" data-id="clhlnylfl00d7ojup229e2wy3" data-title="MongoDB 备份与恢复" class="article-share-link"><span class="fa fa-share">分享</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/MongoDB/" rel="tag">MongoDB</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/nosql/" rel="tag">nosql</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-blog/nosql/mongodb/shard" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/blog/nosql/mongodb/shard/" class="article-date">
  <time class="dt-published" datetime="2016-04-17T10:15:08.000Z" itemprop="datePublished">2016-04-17</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/nosql/">nosql</a>►<a class="article-category-link" href="/categories/nosql/MongoDB/">MongoDB</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/blog/nosql/mongodb/shard/">MongoDB 分片</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>在Mongodb里面存在另一种集群，就是分片技术,可以满足MongoDB数据量大量增长的需求。</p>
<p>当MongoDB存储海量的数据时，一台机器可能不足以存储数据也足以提供可接受的读写吞吐量。这时，我们就可以通过在多台机器上分割数据，使得数据库系统能存储和处理更多的数据。</p>
<p>为什么使用分片</p>
<ul>
<li>复制所有的写入操作到主节点</li>
<li>延迟的敏感数据会在主节点查询</li>
<li>单个副本集限制在12个节点</li>
<li>当请求量巨大时会出现内存不足。</li>
<li>本地磁盘不足</li>
<li>垂直扩展价格昂贵</li>
</ul>
<p>下图展示了在MongoDB中使用分片集群结构分布：</p>
<p><img src="/images/mongodb/sharding.png"></p>
<p>上图中主要有如下所述三个主要组件：</p>
<ul>
<li><p><strong>Shard:</strong></p>
<p>用于存储实际的数据块，实际生产环境中一个shard<br>server角色可由几台机器组个一个relica set承担，防止主机单点故障</p>
</li>
<li><p><strong>Config Server:</strong></p>
<p>mongod实例，存储了整个 ClusterMetadata，其中包括 chunk信息。</p>
</li>
<li><p><strong>Query Routers:</strong></p>
<p>前端路由，客户端由此接入，且让整个集群看上去像单一数据库，前端应用可以透明使用。</p>
</li>
</ul>
<h2 id="启动服务器"><a href="#启动服务器" class="headerlink" title="启动服务器"></a>启动服务器</h2><p>首先要启动配制服务器和mongos</p>
<p><strong>启动config服务器</strong></p>
<pre><code>./mongod --dbpath ~/dbs/config --port 20000
</code></pre>
<p><strong>启动mongos</strong></p>
<p>mongos不需要数据目录，但要指定配制服务器地址。</p>
<pre><code>./mongos --port 30000 --configdb localhost:20000
</code></pre>
<p>分片处理通过mongos完成。</p>
<p><strong>添加片服务器</strong></p>
<pre><code>./mongod --dbpath ~/dbs/shard1 --port 40000
./mongod --dbpath ~/dbs/shard1 --port 50000
</code></pre>
<p><strong>添加分片</strong></p>
<p>连接上mongos</p>
<pre><code>./mongo localhost:30000
</code></pre>
<p>用addshard添加分片</p>
<pre><code>sh.addShard(&quot;localhost:40000&quot;)
sh.addShard(&quot;localhost:50000&quot;)
</code></pre>
<p>addShard参数可以是：</p>
<pre><code>[hostname]
[hostname]:[port]
[replica-set-name]/[hostname]
[replica-set-name]/[hostname]:port
</code></pre>
<h2 id="设置分片"><a href="#设置分片" class="headerlink" title="设置分片"></a>设置分片</h2><p>片已经集群了，但是mongos不知道该如何切分数据，也就是我们先前所说的片键，在mongodb中设置片键要做两步</p>
<p>开启数据库分片功能，命令很简单 enablesharding(),这里我就开启test数据库。</p>
<p>指定集合中分片的片键，这里我就指定为person.name字段。</p>
<pre><code>sh.enableSharding(&quot;test&quot;)
shshardCollection(&quot;test.person&quot;,&#123;&quot;name&quot;:1&#125;)
</code></pre>
<p>好了，至此我们的分片操作全部结束，接下来我们通过mongos向mongodb插入10w记录，然后通过printShardingStatus命令查看mongodb的数据分片情况。</p>
<pre><code>mongos&gt; for(var i=0;i&lt;100000;i++)&#123; db.person.insert(&#123;&quot;name&quot;:&quot;jack&quot;+i,&quot;age&quot;:i&#125;);&#125;
</code></pre>
<p>连接config服务器查看分片情况：</p>
<pre><code>mongo localhost:20000
MongoDB shell version: 3.2.4
connecting to: localhost:20000/test
&gt; db.printShardingStatus()
--- Sharding Status ---
  sharding version: &#123;
        &quot;_id&quot; : 1,
        &quot;minCompatibleVersion&quot; : 5,
        &quot;currentVersion&quot; : 6,
        &quot;clusterId&quot; : ObjectId(&quot;571353399c909c0a94401956&quot;)
&#125;
  shards:
        &#123;  &quot;_id&quot; : &quot;shard0000&quot;,  &quot;host&quot; : &quot;localhost:8001&quot; &#125;
        &#123;  &quot;_id&quot; : &quot;shard0001&quot;,  &quot;host&quot; : &quot;localhost:8002&quot; &#125;
  active mongoses:
        &quot;3.2.4&quot; : 1
  balancer:
        Currently enabled:  yes
        Currently running:  no
        Failed balancer rounds in last 5 attempts:  0
        Migration Results for the last 24 hours:
                1 : Success
  databases:
        &#123;  &quot;_id&quot; : &quot;test&quot;,  &quot;primary&quot; : &quot;shard0000&quot;,  &quot;partitioned&quot; : true &#125;
                test.person
                        shard key: &#123; &quot;name&quot; : 1 &#125;
                        unique: false
                        balancing: true
                        chunks:
                                shard0000       2
                                shard0001       1
                        &#123; &quot;name&quot; : &#123; &quot;$minKey&quot; : 1 &#125; &#125; --&gt;&gt; &#123; &quot;name&quot; : &quot;jack1&quot; &#125; on : shard0001 Timestamp(2, 0)
                        &#123; &quot;name&quot; : &quot;jack1&quot; &#125; --&gt;&gt; &#123; &quot;name&quot; : &quot;jack6&quot; &#125; on : shard0000 Timestamp(2, 1)
                        &#123; &quot;name&quot; : &quot;jack6&quot; &#125; --&gt;&gt; &#123; &quot;name&quot; : &#123; &quot;$maxKey&quot; : 1 &#125; &#125; on : shard0000 Timestamp(1, 3)

&gt;
</code></pre>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.onekbase.com/blog/nosql/mongodb/shard/" data-id="clhlnylfq00e2ojupgcgy2dpd" data-title="MongoDB 分片" class="article-share-link"><span class="fa fa-share">分享</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/MongoDB/" rel="tag">MongoDB</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/nosql/" rel="tag">nosql</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-blog/nosql/mongodb/replset" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/blog/nosql/mongodb/replset/" class="article-date">
  <time class="dt-published" datetime="2016-04-16T11:22:27.000Z" itemprop="datePublished">2016-04-16</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/nosql/">nosql</a>►<a class="article-category-link" href="/categories/nosql/MongoDB/">MongoDB</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/blog/nosql/mongodb/replset/">MongoDB 复制（副本集）</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>MongoDB复制是将数据同步在多个服务器的过程。</p>
<p>复制提供了数据的冗余备份，并在多个服务器上存储数据副本，提高了数据的可用性，并可以保证数据的安全性。</p>
<p>复制还允许您从硬件故障和服务中断中恢复数据。</p>
<h2 id="为什么需要复制"><a href="#为什么需要复制" class="headerlink" title="为什么需要复制?"></a>为什么需要复制?</h2><ul>
<li>保障数据的安全性</li>
<li>数据高可用性 (24*7)</li>
<li>灾难恢复</li>
<li>无需停机维护（如备份，重建索引，压缩）</li>
<li>分布式读取数据</li>
</ul>
<h2 id="MongoDB复制原理"><a href="#MongoDB复制原理" class="headerlink" title="MongoDB复制原理"></a>MongoDB复制原理</h2><p>mongodb的复制至少需要两个节点。其中一个是主节点，负责处理客户端请求，其余的都是从节点，负责复制主节点上的数据。</p>
<p>mongodb各个节点常见的搭配方式为：一主一从、一主多从。</p>
<p>主节点记录在其上的所有操作oplog，从节点定期轮询主节点获取这些操作，然后对自己的数据副本执行这些操作，从而保证从节点的数据与主节点一致。</p>
<p>MongoDB复制结构图如下所示：</p>
<p><img src="/images/mongodb/replication.png" alt="MongoDB复制结构图"></p>
<p>以上结构图总，客户端总主节点读取数据，在客户端写入数据到主节点是，主节点与从节点进行数据交互保障数据的一致性。</p>
<h2 id="一般主从复制"><a href="#一般主从复制" class="headerlink" title="一般主从复制"></a>一般主从复制</h2><p>主服务添加启动参数”–master”，从服务器添加启动参数”–slave”。</p>
<p>从服务器会从local数据库，sources数据集中找主服务器配制进行同步操作。</p>
<p>主服务器的信息可以有多条，因为可以从不同的服务器同步不同的数据库，这是通过only参数指定的。多个主节点的集合如果相同，MongoDB会尝试合并，但不会保证合并的正确性！所以尽量在多个主节点上使用不同的命名空间！</p>
<p>如下：</p>
<pre><code>&gt; db.sources.insert(&#123;&quot;host&quot;:&quot;localhost:10000&quot;, &quot;only&quot;:&quot;testdb&quot;&#125;);  
</code></pre>
<p>可以从启动参数设置主服务器，用参数”–source&#x3D;hostname:port”。在第一次启动后信息会记录在local.sources中，以后启动就不需要了。如果主服务记录要更改要连接到服务器上对文档进行更改。</p>
<p>其它参数：</p>
<p>–slavedelay<br>：这个选项用在启动从服务器上，指定从服务器从主服务器上同步操作的延时时间，这对于一些无意的删除重要数据或插入垃圾数据有一定的防护作用，通过延时，可暂缓这些不良操作在从服务器上被执行！</p>
<p>–fastsync<br>：这个选项用在启动从服务器上。表明以主服务器节点的数据快照为基础启动从服务器节点。因为从服务节点启动后，要先完整同步主服务节点上的数据，然后再获取主服务节点的oplog来保持后续的同步。使用这个启动参数，从服务器节点的启动要比完整同步快很多！</p>
<p>–autoresync<br>：这个选项用在启动从服务器节点上。如果从节点与主节点不同步了，则自动重新同步。</p>
<p>–oplogSize<br>：启动主服务器时显示指定放置oplog的集合所占据的空间大小。MongoDB有一个默认的规则（磁盘分区剩余空间的5%，上篇有提及），这个选项可以优于这个规则来显示指定。</p>
<p>【autoresync选项详细解释】</p>
<p>使用这个选项启动从服务器，当从服务器停止同步时，会自动启动重新完整同步操作。那从服务器什么情况会停止同步呢？从节点启动时，都会首先进行完整同步，然后再读取主节点的oplog保持数据同步。如果此时主节点数据太多，且写操作频繁，会导致从节点跟不上主节点的操作，有可能当完整同步完成，oplog已经绕了一圈了（固定集合）。这时从节点会停止同步，此时我们可以手动在从节点上执行命令db.runCommand({“resync”<br>:<br>1})来强制从节点再进行一遍完整同步，使用–autoresync选项启动的从节点这时会自动重新进行一遍完整同步！完整同步代价比较高，应尽量避免，较好的方式就是设置足够大的oplog！</p>
<p>启动主服务：</p>
<pre><code>./mongodb --dbpath ~/dbs/master --port 8000 --master
</code></pre>
<p>启动从服务：</p>
<pre><code>./mongodb --dbpath ~/dbs/slave --port 8001 --slave --source 127.0.0.1:8000
</code></pre>
<p>如果不设置source参数，启动后会提示如下信息，因为设置了slave参数：</p>
<pre><code>[replslave] no source given, add a master to local.sources to start replication
</code></pre>
<p>可以通过客户端连接上在local.sources里插入文档进行主服务器配制。</p>
<p>如下：</p>
<pre><code>&gt; db.sources.insert(&#123;&quot;host&quot;:&quot;localhost:10000&quot;&#125;);  
</code></pre>
<h2 id="副本集"><a href="#副本集" class="headerlink" title="副本集"></a>副本集</h2><p>先说一下副本集的概念：有自动故障恢复功能的主从结构！前面讲到的主从结构和副本集最大的区别就是：副本集没有固定的“主节点”，整个集群结构会动态选举出一个“主节点”，当其不能工作了，则会动态变更到其他节点。副本集对其节点又特殊的称呼：活跃节点（“主节点”）和<br>备份节点（“从节点”）。</p>
<p><strong>副本集特征：</strong></p>
<ul>
<li>N 个节点的集群</li>
<li>任何节点可作为主节点</li>
<li>所有写入操作都在主节点上</li>
<li>自动故障转移</li>
<li>自动恢复</li>
</ul>
<p>副本集最美妙的地方是其自动化，在当前活跃节点因故障停止时，备份节点会自动升级为活跃节点！以维持系统的正常运行。</p>
<p>我们首先需要为副本集起一个名称，如比settest。</p>
<p>然后使用选项–replSet来起动三个数据库服务Instances(约定为一个复制集合）：</p>
<pre><code>./mongod --dbpath ~/dbs/node1 --port 10001 --replSet settest
./mongod --dbpath ~/dbs/node2 --port 10002 --replSet settest
./mongod --dbpath ~/dbs/node3 --port 10003 --replSet settest
</code></pre>
<p>集合中local.system.replset中没有任何配置信息，并且副本集还需要在shell中运行replSetInitiate命令来进行初始化。我们通过其中任意一台服务器运行命令初始化（注意该命令需要在admin数据库下执行），该集合中会自动插入配置信息，并且配置信息会在副本集内各个服务器间被复制：</p>
<pre><code>&gt; use admin
switched to db admin
&gt;rsconfig=&#123;
... &quot;_id&quot; : &quot;settest&quot;,
... &quot;members&quot; : [
...     &#123;
...         &quot;_id&quot; :1,
...         &quot;host&quot;: &quot;&lt; hostname&gt;&gt;:10001&quot;
...     &#125;,
...     &#123;
...         &quot;_id&quot; : 2,
...         &quot;host&quot; : &quot;&lt; hostname&gt;:10002&quot;
...     &#125;,
...     &#123;
...         &quot;_id&quot; : 3,
...         &quot;host&quot; : &quot;&lt; hostname&gt;:10003&quot;
...     &#125;
... ]&#125;
&gt; db.runCommand(&#123;&quot;replSetInitiate&quot; :rsconfig&#125;);
</code></pre>
<p>hostname为主机名，在一台机器上做测试都是一样的，当然用localhost或ip也可以，但不同的版本好像有的不行。</p>
<p>在新的版本中已经有了更简洁的命令rs.initiate,这是对replSetInitiate的包装：</p>
<pre><code>&gt;rs.initiate( rsconfig )
</code></pre>
<p>rs相关命令不需要在admin数据库下执行。</p>
<p>当然还可以分开操作：</p>
<pre><code>rs.initiate()
&gt;rs.add(&quot;&lt; hostname&gt;:10001&quot;)
&gt;rs.add(&quot;&lt; hostname&gt;:10002&quot;)
&gt;rs.add(&quot;&lt; hostname&gt;:10003&quot;)
</code></pre>
<p>如果设置成功，mongo的提示符会变成”副本集:PRIMARY&gt;”或”副本集:SECONDARY&gt;”格式，视连接的服务是主是从而定。</p>
<p>集群的配制只要配制一次，以后重启不用再次配制，因为都已经存储到数据库里了。</p>
<p>我们可以使用rs.conf()来查看副本集的配置。</p>
<p>查看副本集姿态使用 rs.status() 命令。</p>
<p>而且还可以用rs.add命令随时添加新成员。</p>
<p>MongoDB中你只能通过主节点将Mongo服务添加到副本集中，判断当前运行的Mongo服务是否为主节点可以使用命令db.isMaster()<br>。</p>
<h2 id="读扩展"><a href="#读扩展" class="headerlink" title="读扩展"></a>读扩展</h2><p>用MongoDB扩展读取的一种方式就是将查询放在从节点上，这样主节点的负载就会减轻。当负载是读取密集型时，这是一个不错的方案！扩展读取本身非常简单，像往常一样设置主从结构。唯一的技巧就是查询时显示指明查询选项slaveOkey，告诉从服务器是否可以处理请求（默认不可以）！所有的MongoDB驱动都会有一个机制来设置这个查询选项！</p>
<p>使用主从结构进行读扩展，我们必须清楚主从的数据同步有一定的时间间隙，如果不能承受这个间隙，就无法采用这个方案来减轻主节点数据查询的压力！</p>
<p>如果通过shell访问mongo，要在secondary进行查询。会出现如下错误：</p>
<pre><code>error: &#123; &quot;$err&quot; : &quot;not master and slaveOk=false&quot;, &quot;code&quot; : 13435 &#125;
</code></pre>
<p>有两种方法实现从机的查询：</p>
<p>第一种方法：db.getMongo().setSlaveOk();</p>
<p>第二种方法：rs.slaveOk();</p>
<p>但是这种方式有一个缺点就是，下次再通过mongo进入实例的时候，查询仍然会报错，为此可以通过下列方式</p>
<p>vi ~&#x2F;.mongorc.js</p>
<p>增加一行rs.slaveOk();这样的话以后每次通过mongo命令进入都可以查询了</p>
<p>如果是通过java访问secondary的话则会报下面的异常</p>
<pre><code>com.mongodb.MongoException: not talking to master and retries used up
</code></pre>
<p>解决方法：</p>
<p>第一种</p>
<pre><code>dbFactory.getDb().slaveOk();
</code></pre>
<p>第二种</p>
<p>在复制集中优先读secondary，如果secondary访问不了的时候就从master中读</p>
<pre><code>dbFactory.getDb().setReadPreference(ReadPreference.secondaryPreferred());
</code></pre>
<p>第三种</p>
<p>只从secondary中读，如果secondary访问不了的时候就不能进行查询</p>
<pre><code>dbFactory.getDb().setReadPreference(ReadPreference.secondary());
</code></pre>
<p>第四种</p>
<p>在配置mongo的时候增加slave-ok&#x3D;”true”也支持直接从secondary中读</p>
<pre><code>&lt; mongo:mongo id=&quot;mongo&quot; host=&quot;$&#123;mongodb.host&#125;&quot; port=&quot;$&#123;mongodb.port&#125;&quot;&gt;
        &lt; mongo:options slave-ok=&quot;true&quot;/&gt; 
</code></pre>
<h2 id="用从节点做数据处理源"><a href="#用从节点做数据处理源" class="headerlink" title="用从节点做数据处理源"></a>用从节点做数据处理源</h2><p>节点的另一个作用就是作为密集型数据处理的数据源，从而避免这种操作影响主节点的性能！此时我们启动从节点，需要同时使用–slave<br>和<br>–master选项（如果单纯使用–slave启动的从节点无法执行写操作），这样启动的从节点会从主节点同步数据，并且本身也可以同时进行读写操作！</p>
<p>使用这种技术时，我们必须保证不能对正在复制主节点数据的从节点上的数据库执行写入操作（从节点可以在不用进行同步的数据库上执行写操作）！从节点无法恢复这些操作，就不能正确映射主节点的数据了。</p>
<p>使用这种技术时，从节点第一次启动不能携带需要被复制的同名数据库（主节点上的），要是有的话，这个数据库就不能进行初始的完整同步操作了，只能进行后续的oplog操作！这样容易造成主从数据不一致！</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.onekbase.com/blog/nosql/mongodb/replset/" data-id="clhlnylfp00dwojup8qdmaocp" data-title="MongoDB 复制（副本集）" class="article-share-link"><span class="fa fa-share">分享</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/MongoDB/" rel="tag">MongoDB</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/nosql/" rel="tag">nosql</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-blog/nosql/nosql" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/blog/nosql/nosql/" class="article-date">
  <time class="dt-published" datetime="2016-04-10T09:50:15.000Z" itemprop="datePublished">2016-04-10</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/nosql/">nosql</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/blog/nosql/nosql/">NoSQL 简介</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>NoSQL(NoSQL &#x3D; Not Only SQL )，意即”不仅仅是SQL”。</p>
<p>在现代的计算系统上每天网络上都会产生庞大的数据量。</p>
<p>这些数据有很大一部分是由关系数据库管理系统（RDMBSs）来处理。 1970年E.F.Codd’s提出的关系模型的论文 “A relational model of data for large shared data banks”，这使得数据建模和应用程序编程更加简单。</p>
<p>通过应用实践证明，关系模型是非常适合于客户服务器编程，远远超出预期的利益，今天它是结构化数据存储在网络和商务应用的主导技术。</p>
<p>NoSQL是一项全新的数据库革命性运动，早期就有人提出，发展至2009年趋势越发高涨。NoSQL的拥护者们提倡运用非关系型的数据存储，相对于铺天盖地的关系型数据库运用，这一概念无疑是一种全新的思维的注入。</p>
<h2 id="关系型数据库遵循ACID规则"><a href="#关系型数据库遵循ACID规则" class="headerlink" title="关系型数据库遵循ACID规则"></a>关系型数据库遵循ACID规则</h2><p>事务在英文中是transaction，和现实世界中的交易很类似，它有如下四个特性：</p>
<p><strong>1、A (Atomicity) 原子性</strong></p>
<p>原子性很容易理解，也就是说事务里的所有操作要么全部做完，要么都不做，事务成功的条件是事务里的所有操作都成功，只要有一个操作失败，整个事务就失败，需要回滚。</p>
<p>比如银行转账，从A账户转100元至B账户，分为两个步骤：1）从A账户取100元；2）存入100元至B账户。这两步要么一起完成，要么一起不完成，如果只完成第一步，第二步失败，钱会莫名其妙少了100元。</p>
<p><strong>2、C (Consistency) 一致性</strong></p>
<p>一致性也比较容易理解，也就是说数据库要一直处于一致的状态，事务的运行不会改变数据库原本的一致性约束。</p>
<p>例如现有完整性约束a+b&#x3D;10，如果一个事务改变了a，那么必须得改变b，使得事务结束后依然满足a+b&#x3D;10，否则事务失败。</p>
<p><strong>3、I (Isolation) 独立性</strong></p>
<p>所谓的独立性是指并发的事务之间不会互相影响，如果一个事务要访问的数据正在被另外一个事务修改，只要另外一个事务未提交，它所访问的数据就不受未提交事务的影响。</p>
<p>比如现有有个交易是从A账户转100元至B账户，在这个交易还未完成的情况下，如果此时B查询自己的账户，是看不到新增加的100元的。</p>
<p><strong>4、D (Durability) 持久性</strong><br>持久性是指一旦事务提交后，它所做的修改将会永久的保存在数据库上，即使出现宕机也不会丢失。</p>
<h2 id="分布式系统"><a href="#分布式系统" class="headerlink" title="分布式系统"></a>分布式系统</h2><p>分布式系统（distributedsystem）由多台计算机和通信的软件组件通过计算机网络连接（本地网络或广域网）组成。</p>
<p>分布式系统是建立在网络之上的软件系统。正是因为软件的特性，所以分布式系统具有高度的内聚性和透明性。</p>
<p>因此，网络和分布式系统之间的区别更多的在于高层软件（特别是操作系统），而不是硬件。</p>
<p>分布式系统可以应用在在不同的平台上如：Pc、工作站、局域网和广域网上等。</p>
<h2 id="分布式计算的优点"><a href="#分布式计算的优点" class="headerlink" title="分布式计算的优点"></a>分布式计算的优点</h2><p><strong>可靠性（容错） ：</strong></p>
<p>分布式计算系统中的一个重要的优点是可靠性。一台服务器的系统崩溃并不影响到其余的服务器。</p>
<p><strong>可扩展性：</strong></p>
<p>在分布式计算系统可以根据需要增加更多的机器。</p>
<p><strong>资源共享：</strong></p>
<p>共享数据是必不可少的应用，如银行，预订系统。</p>
<p><strong>灵活性：</strong></p>
<p>由于该系统是非常灵活的，它很容易安装，实施和调试新的服务。</p>
<p><strong>更快的速度：</strong></p>
<p>分布式计算系统可以有多台计算机的计算能力，使得它比其他系统有更快的处理速度。</p>
<p><strong>开放系统：</strong></p>
<p>由于它是开放的系统，本地或者远程都可以访问到该服务。</p>
<p><strong>更高的性能：</strong></p>
<p>相较于集中式计算机网络集群可以提供更高的性能（及更好的性价比）。</p>
<h2 id="分布式计算的缺点"><a href="#分布式计算的缺点" class="headerlink" title="分布式计算的缺点"></a>分布式计算的缺点</h2><p><strong>故障排除： ：</strong></p>
<p>故障排除和诊断问题。</p>
<p><strong>软件：</strong></p>
<p>更少的软件支持是分布式计算系统的主要缺点。</p>
<p><strong>网络：</strong></p>
<p>网络基础设施的问题，包括：传输问题，高负载，信息丢失等。</p>
<p><strong>安全性：</strong></p>
<p>开发系统的特性让分布式计算系统存在着数据的安全性和共享的风险等问题。</p>
<h2 id="什么是NoSQL"><a href="#什么是NoSQL" class="headerlink" title="什么是NoSQL?"></a>什么是NoSQL?</h2><p>NoSQL，指的是非关系型的数据库。NoSQL有时也称作Not OnlySQL的缩写，是对不同于传统的关系型数据库的数据库管理系统的统称。</p>
<p>NoSQL用于超大规模数据的存储。（例如谷歌或Facebook每天为他们的用户收集万亿比特的数据）。这些类型的数据存储不需要固定的模式，无需多余操作就可以横向扩展。</p>
<h2 id="为什么使用NoSQL"><a href="#为什么使用NoSQL" class="headerlink" title="为什么使用NoSQL ?"></a>为什么使用NoSQL ?</h2><p>今天我们可以通过第三方平台（如：Google,Facebook等）可以很容易的访问和抓取数据。用户的个人信息，社交网络，地理位置，用户生成的数据和用户操作日志已经成倍的增加。我们如果要对这些用户数据进行挖掘，那SQL数据库已经不适合这些应用了,NoSQL数据库的发展也却能很好的处理这些大的数据。</p>
<p><img src="/images/nosql/web-data-image.png" alt="web-data-image"></p>
<h2 id="RDBMS-vs-NoSQL"><a href="#RDBMS-vs-NoSQL" class="headerlink" title="RDBMS vs NoSQL"></a>RDBMS vs NoSQL</h2><p><strong>RDBMS</strong></p>
<ul>
<li>高度组织化结构化数据</li>
<li>结构化查询语言（SQL） (SQL)</li>
<li>数据和关系都存储在单独的表中。</li>
<li>数据操纵语言，数据定义语言</li>
<li>严格的一致性</li>
<li>基础事务</li>
</ul>
<p><strong>NoSQL</strong></p>
<ul>
<li>代表着不仅仅是SQL</li>
<li>没有声明性查询语言</li>
<li>没有预定义的模式-键 - 值对存储，列存储，文档存储，图形数据库</li>
<li>最终一致性，而非ACID属性</li>
<li>非结构化和不可预知的数据</li>
<li>CAP定理</li>
<li>高性能，高可用性和可伸缩性</li>
</ul>
<p><img src="/images/nosql/bigdata.png" alt="bigdata"></p>
<h2 id="NoSQL-简史"><a href="#NoSQL-简史" class="headerlink" title="NoSQL 简史"></a>NoSQL 简史</h2><p>NoSQL一词最早出现于1998年，是Carlo Strozzi开发的一个轻量、开源、不提供SQL功能的关系数据库。</p>
<p>2009年，Last.fm的JohanOskarsson发起了一次关于分布式开源数据库的讨论[2]，来自Rackspace的Eric<br>Evans再次提出了NoSQL的概念，这时的NoSQL主要指非关系型、分布式、不提供ACID的数据库设计模式。</p>
<p>2009年在亚特兰大举行的”no:sql(east)”讨论会是一个里程碑，其口号是”select fun, profit from real_world where relational&#x3D;false;”。因此，对NoSQL最普遍的解释是”非关联型的”，强调Key-Value Stores和文档数据库的优点，而不是单纯的反对RDBMS。</p>
<h2 id="CAP定理（CAP-theorem）"><a href="#CAP定理（CAP-theorem）" class="headerlink" title="CAP定理（CAP theorem）"></a>CAP定理（CAP theorem）</h2><p>在计算机科学中, CAP定理（CAP theorem）, 又被称作 布鲁尔定理（Brewer’s theorem）, 它指出对于一个分布式计算系统来说，不可能同时满足以下三点:</p>
<ul>
<li><strong>一致性(Consistency)</strong> (所有节点在同一时间具有相同的数据)</li>
<li><strong>可用性(Availability)</strong> (保证每个请求不管成功或者失败都有响应)</li>
<li><strong>分隔容忍(Partition tolerance)</strong> (系统中任意信息的丢失或失败不会影响系统的继续运作)</li>
</ul>
<p>CAP理论的核心是：一个分布式系统不可能同时很好的满足一致性，可用性和分区容错性这三个需求，最多只能同时较好的满足两个。</p>
<p>因此，根据 CAP 原理将 NoSQL 数据库分成了满足 CA 原则、满足 CP 原则和满足AP 原则三 大类：</p>
<ul>
<li>CA - 单点集群，满足一致性，可用性的系统，通常在可扩展性上不太强大。</li>
<li>CP - 满足一致性，分区容忍必的系统，通常性能不是特别高。</li>
<li>AP - 满足可用性，分区容忍性的系统，通常可能对一致性要求低一些。</li>
</ul>
<p><img src="/images/nosql/cap-theoram-image.png" alt="cap-theoram-image"></p>
<h2 id="NoSQL的优点-x2F-缺点"><a href="#NoSQL的优点-x2F-缺点" class="headerlink" title="NoSQL的优点&#x2F;缺点"></a>NoSQL的优点&#x2F;缺点</h2><p>优点:</p>
<ul>
<li><ul>
<li>高可扩展性</li>
</ul>
</li>
<li><ul>
<li>分布式计算</li>
</ul>
</li>
<li><ul>
<li>低成本</li>
</ul>
</li>
<li><ul>
<li>架构的灵活性，半结构化数据</li>
</ul>
</li>
<li><ul>
<li>没有复杂的关系</li>
</ul>
</li>
</ul>
<p>缺点:</p>
<ul>
<li><ul>
<li>没有标准化</li>
</ul>
</li>
<li><ul>
<li>有限的查询功能（到目前为止）</li>
</ul>
</li>
<li><ul>
<li>最终一致是不直观的程序</li>
</ul>
</li>
</ul>
<h2 id="BASE"><a href="#BASE" class="headerlink" title="BASE"></a>BASE</h2><p>BASE：Basically Available, Soft-state, Eventually Consistent。 由 Eric Brewer 定义。</p>
<p>CAP理论的核心是：一个分布式系统不可能同时很好的满足一致性，可用性和分区容错性这三个需求，最多只能同时较好的满足两个。</p>
<p>BASE是NoSQL数据库通常对可用性及一致性的弱要求原则:</p>
<ul>
<li>Basically Availble –基本可用</li>
<li>Soft-state –软状态&#x2F;柔性事务。”Soft state” 可以理解为”无连接”的, 而<br>“Hard state” 是”面向连接”的</li>
<li>Eventual Consistency –最终一致性最终一致性， 也是是 ACID<br>的最终目的。</li>
</ul>
<h2 id="ACID-vs-BASE"><a href="#ACID-vs-BASE" class="headerlink" title="ACID vs BASE"></a>ACID vs BASE</h2><p> | ACID                 |   BASE<br> | ———————|– —————————————<br> | 原子性(<strong>A</strong>tomicity)   |基本可用(<strong>B</strong>asically <strong>A</strong>vailable)<br> | 一致性(<strong>C</strong>onsistency) |软状态&#x2F;柔性事务(<strong>S</strong>oft state)<br> | 隔离性(<strong>I</strong>solation)   |最终一致性(<strong>E</strong>ventual consistency)<br> | 持久性(<strong>D</strong>urable)     | </p>
<h2 id="NoSQL-数据库分类"><a href="#NoSQL-数据库分类" class="headerlink" title="NoSQL 数据库分类"></a>NoSQL 数据库分类</h2><table><tbody><tr><td>类型</td><td>部分代表<p></p></td><td>特点</td></tr><tr><td>列存储</td><td><p>Hbase </p><p>Cassandra </p><p>Hypertable </p></td><td><p>顾名思义，是按列存储数据的。最大的特点是方便存储结构化和半结构化数据，方便做数据压缩，对针对某一列或者某几列的查询有非常大的IO优势。 </p></td></tr><tr><td><p>文档存储 </p></td><td><p>MongoDB </p><p>CouchDB </p></td><td><p>文档存储一般用类似json的格式存储，存储的内容是文档型的。这样也就有有机会对某些字段建立索引，实现关系数据库的某些功能。 </p></td></tr><tr><td><p>key-value存储 </p></td><td><p>Tokyo?Cabinet?/?Tyrant </p><p>Berkeley?DB </p><p>MemcacheDB </p><p>Redis </p></td><td><p>可以通过key快速查询到其value。一般来说，存储不管value的格式，照单全收。（Redis包含了其他功能） </p></td></tr><tr><td><p>图存储 </p></td><td><p>Neo4J </p><p>FlockDB </p></td><td><p>图形关系的最佳存储。使用传统关系数据库来解决的话性能低下，而且设计使用不方便。 </p></td></tr><tr><td><p>对象存储 </p></td><td><p>db4o </p><p>Versant </p></td><td><p>通过类似面向对象语言的语法操作数据库，通过对象的方式存取数据。 </p></td></tr><tr><td><p>xml数据库 </p></td><td><p>Berkeley?DB?XML </p><p>BaseX </p></td><td><p>高效的存储XML数据，并支持XML的内部查询语法，比如XQuery,Xpath。 </p></td></tr></tbody></table>
谁在使用
--------

<p>现在已经有很多公司使用了 NoSQL：</p>
<ul>
<li>Google</li>
<li>Facebook</li>
<li>Mozilla</li>
<li>Adobe</li>
<li>Foursquare</li>
<li>LinkedIn</li>
<li>Digg</li>
<li>McGraw-Hill Education</li>
<li>Vermont Public Radio</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.onekbase.com/blog/nosql/nosql/" data-id="clhlnyld10003ojup6j68ckqg" data-title="NoSQL 简介" class="article-share-link"><span class="fa fa-share">分享</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/nosql/" rel="tag">nosql</a></li></ul>

    </footer>
  </div>
  
</article>



  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/page/8/">&laquo; 上一页</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/7/">7</a><a class="page-number" href="/page/8/">8</a><span class="page-number current">9</span><a class="page-number" href="/page/10/">10</a><a class="page-number" href="/page/11/">11</a><span class="space">&hellip;</span><a class="page-number" href="/page/37/">37</a><a class="extend next" rel="next" href="/page/10/">下一页 &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">分类</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/JAVA-WEB/">JAVA WEB</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/JAVA-WEB/Spring-Boot/">Spring Boot</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/WEB%E5%BC%80%E5%8F%91/">WEB开发</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/maven/">maven</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/nosql/">nosql</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/nosql/MongoDB/">MongoDB</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%9F%BA%E7%A1%80/">基础</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%9F%BA%E7%A1%80/%E5%AD%97%E7%AC%A6%E9%9B%86/">字符集</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/">大数据</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/spark/">spark</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%B7%A5%E5%85%B7/">工具</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%B7%A5%E5%85%B7/Emacs/">Emacs</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%B7%A5%E5%85%B7/GIT/">GIT</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%B7%A5%E5%85%B7/VIM/">VIM</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/">操作系统</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/linux/">linux</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/%E8%87%AA%E5%88%B6%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/">自制操作系统</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%9E%B6%E6%9E%84/">架构</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%9E%B6%E6%9E%84/SSO/">SSO</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%9E%B6%E6%9E%84/%E4%B8%80%E8%87%B4%E6%80%A7/">一致性</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%9E%B6%E6%9E%84/%E4%BB%BB%E5%8A%A1%E8%B0%83%E5%BA%A6/">任务调度</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%9E%B6%E6%9E%84/%E5%8C%BA%E5%9D%97%E9%93%BE/">区块链</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%9E%B6%E6%9E%84/%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86/">反向代理</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%9E%B6%E6%9E%84/%E5%AF%86%E7%A0%81%E6%9C%AF/">密码术</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%9E%B6%E6%9E%84/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97/">消息队列</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%9E%B6%E6%9E%84/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97/JMS/">JMS</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%9E%B6%E6%9E%84/%E7%BB%84%E4%BB%B6/">组件</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%9E%B6%E6%9E%84/%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/">负载均衡</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%9F%A5%E8%AF%86%E4%BD%93%E7%B3%BB/">知识体系</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%AE%97%E6%B3%95/">算法</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%AE%97%E6%B3%95/%E6%8E%92%E5%BA%8F/">排序</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%AE%97%E6%B3%95/%E6%A0%91%E7%AE%97%E6%B3%95/">树算法</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/">编程语言</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C%E8%AF%AD%E8%A8%80/">C语言</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/JAVA/">JAVA</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/JAVA/BASE/">BASE</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/JAVA/IO/">IO</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/JAVA/JAVA8/">JAVA8</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/JAVA/NIO/">NIO</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/JAVA/%E7%BA%BF%E7%A8%8B%E5%AE%89%E5%85%A8/">线程安全</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Lisp/">Lisp</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Lisp/Common-Lisp/">Common Lisp</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Scala/">Scala</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/javascript/">javascript</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/">设计模式</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签云</h3>
    <div class="widget tagcloud">
      <a href="/tags/AOP/" style="font-size: 10.5px;">AOP</a> <a href="/tags/ASCII%E7%A0%81/" style="font-size: 10px;">ASCII码</a> <a href="/tags/ActiveMQ/" style="font-size: 11px;">ActiveMQ</a> <a href="/tags/Ajax/" style="font-size: 10px;">Ajax</a> <a href="/tags/BAT%E8%84%9A%E6%9C%AC/" style="font-size: 10px;">BAT脚本</a> <a href="/tags/CAP/" style="font-size: 10px;">CAP</a> <a href="/tags/CAS/" style="font-size: 10.5px;">CAS</a> <a href="/tags/Common-Lisp/" style="font-size: 13.5px;">Common Lisp</a> <a href="/tags/C%E8%AF%AD%E8%A8%80/" style="font-size: 10.5px;">C语言</a> <a href="/tags/Eclipse/" style="font-size: 11px;">Eclipse</a> <a href="/tags/Emacs/" style="font-size: 16.5px;">Emacs</a> <a href="/tags/Emmet/" style="font-size: 10px;">Emmet</a> <a href="/tags/GIT/" style="font-size: 10px;">GIT</a> <a href="/tags/HttpClient/" style="font-size: 12.5px;">HttpClient</a> <a href="/tags/IPFS/" style="font-size: 10px;">IPFS</a> <a href="/tags/JAVA/" style="font-size: 20px;">JAVA</a> <a href="/tags/JAVA-IO/" style="font-size: 15.5px;">JAVA IO</a> <a href="/tags/JAVA-NIO/" style="font-size: 17px;">JAVA NIO</a> <a href="/tags/JAVA-WEB/" style="font-size: 10.5px;">JAVA WEB</a> <a href="/tags/JAVA8/" style="font-size: 13.5px;">JAVA8</a> <a href="/tags/JWT/" style="font-size: 10px;">JWT</a> <a href="/tags/Lisp/" style="font-size: 12px;">Lisp</a> <a href="/tags/Markdown/" style="font-size: 10.5px;">Markdown</a> <a href="/tags/MongoDB/" style="font-size: 18px;">MongoDB</a> <a href="/tags/SQL/" style="font-size: 15px;">SQL</a> <a href="/tags/Scala/" style="font-size: 11px;">Scala</a> <a href="/tags/Shiro/" style="font-size: 10px;">Shiro</a> <a href="/tags/Spring-Boot/" style="font-size: 10px;">Spring Boot</a> <a href="/tags/Spring-MVC/" style="font-size: 10px;">Spring MVC</a> <a href="/tags/UML/" style="font-size: 10px;">UML</a> <a href="/tags/VIM/" style="font-size: 16px;">VIM</a> <a href="/tags/WEB%E5%BC%80%E5%8F%91/" style="font-size: 11px;">WEB开发</a> <a href="/tags/XML/" style="font-size: 10.5px;">XML</a> <a href="/tags/archtype/" style="font-size: 10px;">archtype</a> <a href="/tags/azkaban/" style="font-size: 10.5px;">azkaban</a> <a href="/tags/hadoop/" style="font-size: 13px;">hadoop</a> <a href="/tags/hexo/" style="font-size: 10px;">hexo</a> <a href="/tags/hive/" style="font-size: 10px;">hive</a> <a href="/tags/javascript/" style="font-size: 14px;">javascript</a> <a href="/tags/jquery/" style="font-size: 10px;">jquery</a> <a href="/tags/linux/" style="font-size: 13px;">linux</a> <a href="/tags/maven/" style="font-size: 12px;">maven</a> <a href="/tags/nosql/" style="font-size: 18.5px;">nosql</a> <a href="/tags/nosql-neo4j/" style="font-size: 11.5px;">nosql neo4j</a> <a href="/tags/openssl/" style="font-size: 11px;">openssl</a> <a href="/tags/servlet/" style="font-size: 11px;">servlet</a> <a href="/tags/spark/" style="font-size: 12px;">spark</a> <a href="/tags/spring/" style="font-size: 10px;">spring</a> <a href="/tags/webservice/" style="font-size: 11px;">webservice</a> <a href="/tags/%E4%B8%80%E8%87%B4%E6%80%A7/" style="font-size: 11.5px;">一致性</a> <a href="/tags/%E4%BB%BB%E5%8A%A1%E8%B0%83%E5%BA%A6/" style="font-size: 10.5px;">任务调度</a> <a href="/tags/%E5%88%86%E5%B8%83%E5%BC%8F/" style="font-size: 10px;">分布式</a> <a href="/tags/%E5%8C%BA%E5%9D%97%E9%93%BE/" style="font-size: 10px;">区块链</a> <a href="/tags/%E5%A4%A7%E6%95%B0%E6%8D%AE/" style="font-size: 17.5px;">大数据</a> <a href="/tags/%E5%AD%97%E7%AC%A6%E7%BC%96%E7%A0%81/" style="font-size: 10px;">字符编码</a> <a href="/tags/%E5%AD%97%E7%AC%A6%E9%9B%86/" style="font-size: 12.5px;">字符集</a> <a href="/tags/%E5%AE%A1%E8%AE%A1/" style="font-size: 10px;">审计</a> <a href="/tags/%E5%AF%86%E7%A0%81%E6%9C%AF/" style="font-size: 14.5px;">密码术</a> <a href="/tags/%E5%B0%BE%E9%80%92%E5%BD%92/" style="font-size: 10px;">尾递归</a> <a href="/tags/%E5%B9%B6%E5%8F%91/" style="font-size: 12px;">并发</a> <a href="/tags/%E6%8E%92%E5%BA%8F/" style="font-size: 14px;">排序</a> <a href="/tags/%E6%91%98%E8%A6%81%E7%AE%97%E6%B3%95/" style="font-size: 10px;">摘要算法</a> <a href="/tags/%E6%95%B0%E5%AD%97%E7%AD%BE%E5%90%8D/" style="font-size: 10.5px;">数字签名</a> <a href="/tags/%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6/" style="font-size: 10px;">数字证书</a> <a href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/" style="font-size: 18.5px;">数据库</a> <a href="/tags/%E6%95%B0%E6%8D%AE%E6%9D%83%E9%99%90/" style="font-size: 10px;">数据权限</a> <a href="/tags/%E6%9D%82%E8%B0%88/" style="font-size: 11.5px;">杂谈</a> <a href="/tags/%E6%9E%B6%E6%9E%84/" style="font-size: 13.5px;">架构</a> <a href="/tags/%E6%A0%91%E7%AE%97%E6%B3%95/" style="font-size: 14px;">树算法</a> <a href="/tags/%E6%AD%A3%E8%A7%84%E8%A1%A8%E8%BE%BE%E5%BC%8F/" style="font-size: 10px;">正规表达式</a> <a href="/tags/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97/" style="font-size: 10px;">消息队列</a> <a href="/tags/%E7%9F%A5%E8%AF%86%E4%BD%93%E7%B3%BB/" style="font-size: 12px;">知识体系</a> <a href="/tags/%E7%A5%9E%E5%99%A8/" style="font-size: 12px;">神器</a> <a href="/tags/%E7%AE%97%E6%B3%95/" style="font-size: 18.5px;">算法</a> <a href="/tags/%E7%BA%BF%E7%A8%8B%E5%AE%89%E5%85%A8/" style="font-size: 19px;">线程安全</a> <a href="/tags/%E8%87%AA%E5%88%B6%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/" style="font-size: 12.5px;">自制操作系统</a> <a href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" style="font-size: 19.5px;">设计模式</a> <a href="/tags/%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/" style="font-size: 13px;">负载均衡</a> <a href="/tags/%E9%94%81/" style="font-size: 11px;">锁</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/blog/explain/">【置顶】公告</a>
          </li>
        
          <li>
            <a href="/blog/tools/maven/dn-cst-maven-archtype/">开发一个maven脚手架</a>
          </li>
        
          <li>
            <a href="/blog/nosql/neo4j/neo4jindustrystock/">neo4j创建行业与股票关系</a>
          </li>
        
          <li>
            <a href="/blog/nosql/neo4j/neo4jindustry/">neo4j创建三级行业关系</a>
          </li>
        
          <li>
            <a href="/blog/nosql/neo4j/neo4jtimeline/">neo4j创建时间线</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2023 证心<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">首页</a>
  
    <a href="/archives" class="mobile-nav-link">归档</a>
  
    <a target="_blank" rel="noopener" href="http://site.onekbase.com" class="mobile-nav-link">ITEEDU</a>
  
    <a href="/about/" class="mobile-nav-link">关于</a>
  
</nav>
    


<script src="/js/jquery-3.6.4.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>